<style media="screen">
  table,th{
    border: 1px solid black;
  }
  th{
    margin-right: 5px
  }
</style>
{% for result in results %}
  <div class="result">
    <h2><a href="{% url 'search_in_database:exact_entity' result.entity_name %}">{{result.entity_name|cut:'_'}}</a></h2>
    {% if result.type in 'concept,instance' %}
      {% for property_group, property_group_value in result.data.items %}
        {# {{property_group_value}} #}
        {% if property_group_value %}
        <table>
          {% if property_group == 'entity' %}
            {% for property, property_value in property_group_value.items %}
              <tr>
                <th>{{property|cut:'_'}}</th>
                <td>
                  {% autoescape off %}
                    {% if property_value.value|length > 1 %}
                      [
                        {% for index in property_value.value %}
                            <a href="{% url 'search_in_database:exact_entity' index %}">{{index|cut:'_'}}</a>
                        {% endfor %}
                      ]
                    {% else %}
                      <a href="{% url 'search_in_database:exact_entity' property_value.value.0 %}">{{property_value.value.0|default_if_none:''|cut:'_'}}</a>
                    {% endif %}
                  {% endautoescape %}
                </td>
                <td>{{property_value.unit|default_if_none:''}}</td>
              </tr>
            {% endfor %}
          {% else %}
            {% for property, property_value in property_group_value.items %}
              <tr>
                <th>{{property|cut:'_'}}</th>
                <td>
                  {% autoescape off %}
                    {% if property_value.value|length > 1 %}
                      {{property_value.value|cut:'_'}}
                    {% else %}
                      {{property_value.value.0|default_if_none:''|cut:'_'}}
                    {% endif %}
                  {% endautoescape %}
                </td>
                <td>{{property_value.unit|default_if_none:''}}</td>
              </tr>
            {% endfor %}
          {% endif %}
        </table>
        {% endif %}
      {% endfor %}

    {% else %}
      <table>
        <tr>
          <th>{{result.property_name|cut:'_'}}</th>
          <td>
            {% if result.data.value|length > 1 %}
              {{result.data.value|cut:'_'}}
            {% else %}
              {% autoescape off %}
                {% if result.data.type == 'entity' %}
                    <a href="{% url 'search_in_database:exact_entity' result.data.value.0 %}">{{result.data.value.0|default_if_none:''|cut:'_'}}</a>

                {% else %}
                  {{result.data.value.0|default_if_none:''|cut:'_'}}
                {% endif %}

              {% endautoescape %}
            {% endif %}
          </td>
          <td>{{result.data.unit|default_if_none:''}}</td>
        </tr>
      </table>
    {% endif %}

  </div>
{% endfor %}
<a href="{% url 'search_in_database:crawler_form' %}">search in web</a>
